// Copyright (C) 2025 azumakuniyuki and sisimai development team, All rights reserved.
// This software is distributed under The BSD 2-Clause License.
package fact

//  _____         _      ______  _____ ____ _____ _  _    __   _  _   
// |_   _|__  ___| |_   / /  _ \|  ___/ ___|___ /| || |  / /_ | || |  
//   | |/ _ \/ __| __| / /| |_) | |_ | |     |_ \| || |_| '_ \| || |_ 
//   | |  __/\__ \ |_ / / |  _ <|  _|| |___ ___) |__   _| (_) |__   _|
//   |_|\___||___/\__/_/  |_| \_\_|   \____|____/   |_|  \___/   |_|  
import "testing"

func TestRFC3464(t *testing.T) {
	publiclist := [][]IsExpected{
		// Label, Index, Status, ReplyCode, Reason, HardBounce, AnotherOne
		{{"01",   1, "5.1.1",   "550", "mailboxfull",     false, ""}},
		{{"01",   1, "5.1.1",   "550", "mailboxfull",     false, ""}},
		{{"03",   1, "5.0.0",   "554", "policyviolation", false, ""}},
		{{"04",   1, "5.5.0",   "554", "systemerror",     false, ""}},
		{{"06",   1, "5.5.0",   "554", "userunknown",      true, ""}},
		{{"07",   1, "4.4.0",   "",    "expired",         false, ""}},
		{{"08",   1, "5.7.1",   "550", "spamdetected",    false, ""}},
		{{"09",   1, "4.3.0",   "",    "mailboxfull",     false, ""}},
		{{"10",   1, "5.1.6",   "550", "hasmoved",         true, ""}},
		{{"26",   1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"28",   1, "2.1.5",   "250", "delivered",       false, ""},
		 {"28",   2, "2.1.5",   "250", "delivered",       false, ""}},
		{{"29",   1, "5.5.0",   "503", "syntaxerror",     false, ""}},
		{{"34",   1, "4.4.1",   "",    "networkerror",    false, ""}},
		{{"35",   1, "5.0.0",   "550", "rejected",        false, ""},
		 {"35",   2, "4.0.0",   "",    "networkerror",    false, ""},
		 {"35",   3, "5.0.0",   "550", "filtered",        false, ""}},
		{{"36",   1, "4.0.0",   ""   , "expired",         false, ""}},
		{{"40",   1, "4.4.6",   "",    "networkerror",    false, ""}},
		{{"42",   1, "5.0.0",   "",    "filtered",        false, ""}},
		{{"43",   1, "4.3.0",   "451", "onhold",          false, ""}},
		{{"51",   1, "5.1.0",   "550", "userunknown",      true, ""}},
		{{"52",   1, "4.0.0",   "",    "notaccept",       false, ""}},
		{{"53",   1, "4.0.0",   "",    "networkerror",    false, ""}},
		{{"54",   1, "4.0.0",   "",    "networkerror",    false, ""}},
		{{"55",   1, "4.4.1",   "",    "expired",         false, ""}},
		{{"56",   1, "4.4.1",   "",    "expired",         false, ""}},
		{{"57",   1, "5.0.0",   "550", "filtered",        false, ""}},
		{{"58",   1, "5.0.0",   "550", "userunknown",      true, ""}},
		{{"59",   1, "4.0.0",   "",    "notaccept",       false, ""}},
		{{"60",   1, "5.1.8",   "501", "rejected",        false, ""}},
		{{"61",   1, "5.0.0",   "",    "spamdetected",    false, ""}},
		{{"62",   1, "4.0.0",   "",    "networkerror",    false, ""}},
		{{"63",   1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"64",   1, "4.0.0",   "",    "networkerror",    false, ""}},
		{{"65",   1, "5.0.0",   "",    "userunknown",      true, ""}},
	}; EngineTest(t, "RFC3464", publiclist, true)

	secretlist := [][]IsExpected{
		// Label, Index, Status, ReplyCode, Reason, HardBounce, AnotherOne
		{{"1003", 1, "5.0.934", "553", "mesgtoobig",      false, ""}},
		{{"1009", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1011", 1, "5.1.2",   "550", "hostunknown",      true, ""}},
		{{"1013", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1014", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1016", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1017", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1020", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1021", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1022", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1031", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1033", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1035", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1036", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1037", 1, "5.5.0",   "554", "systemerror",     false, ""}},
		{{"1038", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1039", 1, "5.1.2",   "550", "hostunknown",      true, ""}},
		{{"1040", 1, "5.4.6",   "554", "networkerror",    false, ""}},
		{{"1041", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1042", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1044", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1046", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1047", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1048", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1049", 1, "5.1.1",   "550", "userunknown",      true, ""},
		 {"1049", 2, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1050", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1051", 1, "5.1.1",   "550", "userunknown",      true, ""},
		 {"1051", 2, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1052", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1053", 1, "5.0.0",   "554", "filtered",        false, ""}},
		{{"1054", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1057", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1058", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1059", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1060", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1062", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1063", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1064", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1065", 1, "5.7.1",   "550", "spamdetected",    false, ""}},
		{{"1066", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1068", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1069", 1, "4.4.7",   "",    "expired",         false, ""}},
		{{"1070", 1, "5.5.0",   "554", "userunknown",      true, ""}},
		{{"1072", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1074", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1076", 1, "5.5.0",   "554", "systemerror",     false, ""}},
		{{"1077", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1083", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1085", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1087", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1089", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1090", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1091", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1092", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1093", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1095", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1096", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1097", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1098", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1099", 1, "4.7.0",   "",    "securityerror",   false, ""}},
		{{"1100", 1, "4.7.0",   "",    "securityerror",   false, ""}},
		{{"1101", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1104", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1107", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1108", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1111", 1, "5.0.922", "",    "mailboxfull",     false, ""}},
		{{"1112", 1, "5.1.0",   "550", "userunknown",      true, ""}},
		{{"1113", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1117", 1, "5.0.934", "553", "mesgtoobig",      false, ""}},
		{{"1118", 1, "4.4.1",   "",    "expired",         false, ""}},
		{{"1120", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1121", 1, "4.4.0",   "",    "expired",         false, ""}},
		{{"1123", 1, "4.4.1",   "",    "expired",         false, ""}},
		{{"1124", 1, "4.0.0",   "",    "systemerror",     false, ""}},
		{{"1126", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1127", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1129", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1131", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1134", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1135", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1136", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1138", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1139", 1, "4.4.1",   "",    "expired",         false, ""}},
		{{"1140", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1142", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1143", 1, "5.0.901", "",    "onhold",          false, ""}},
		{{"1149", 1, "4.4.7",   "",    "expired",         false, ""}},
		{{"1154", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1155", 1, "5.4.6",   "554", "networkerror",    false, ""}},
		{{"1156", 1, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156", 2, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156", 3, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156", 4, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156", 5, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156", 6, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156", 7, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156", 8, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156", 9, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",10, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",11, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",12, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",13, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",14, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",15, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",16, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",17, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",18, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",19, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",20, "5.7.1",   "550", "spamdetected",    false, ""},
		 {"1156",21, "5.7.1",   "550", "spamdetected",    false, ""}},
		{{"1157", 1, "5.3.0",   "",    "filtered",        false, ""}},
		{{"1159", 1, "5.1.1",   "550", "mailboxfull",     false, ""}},
		{{"1163", 1, "5.1.1",   "550", "mesgtoobig",      false, ""}},
		{{"1164", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1183", 1, "5.0.922", "",    "mailboxfull",     false, ""}},
		{{"1212", 1, "4.2.2",   "",    "mailboxfull",     false, ""}},
		{{"1213", 1, "5.0.0",   "501", "spamdetected",    false, ""}},
		{{"1220", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1223", 1, "4.0.0",   "",    "mailboxfull",     false, ""}},
		{{"1229", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1230", 1, "5.2.0",   "",    "filtered",        false, ""}},
		{{"1233", 1, "5.5.0",   "554", "systemerror",     false, ""}},
		{{"1235", 1, "5.0.0",   "550", "filtered",        false, ""},
		 {"1235", 2, "5.0.0",   "550", "filtered",        false, ""},
		 {"1235", 3, "5.0.0",   "550", "filtered",        false, ""},
		 {"1235", 4, "5.0.0",   "550", "filtered",        false, ""}},
		{{"1236", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1237", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1238", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1239", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1240", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1241", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1242", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1243", 1, "5.5.0",   "503", "syntaxerror",     false, ""}},
		{{"1244", 1, "5.2.2",   "",    "mailboxfull",     false, ""}},
		{{"1245", 1, "5.2.2",   "",    "mailboxfull",     false, ""}},
		{{"1246", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1247", 1, "5.1.1",   "",    "userunknown",      true, ""},
		 {"1247", 2, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1248", 1, "5.2.2",   "",    "mailboxfull",     false, ""}},
		{{"1249", 1, "5.5.0",   "503", "syntaxerror",     false, ""}},
		{{"1250", 1, "5.0.922", "",    "mailboxfull",     false, ""}},
		{{"1251", 1, "5.2.2",   "552", "mailboxfull",     false, ""}},
		{{"1252", 1, "5.0.944", "554", "networkerror",    false, ""}},
		{{"1255", 1, "4.4.7",   "",    "expired",         false, ""}},
		{{"1263", 1, "4.4.1",   "",    "networkerror",    false, ""}},
		{{"1265", 1, "5.0.0",   "554", "policyviolation", false, ""}},
		{{"1266", 1, "4.7.0",   "",    "policyviolation", false, ""}},
		{{"1267", 1, "5.1.6",   "550", "hasmoved",         true, ""}},
		{{"1271", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1272", 1, "5.0.980", "554", "spamdetected",    false, ""}},
		{{"1273", 1, "4.3.0",   "",    "mailboxfull",     false, ""}},
		{{"1274", 1, "4.2.2",   "",    "mailboxfull",     false, ""}},
		{{"1277", 1, "5.0.0",   "550", "rejected",        false, ""},
		 {"1277", 2, "4.0.0",   "",    "networkerror",    false, ""},
		 {"1277", 2, "5.0.0",   "550", "filtered",        false, ""}},
		{{"1278", 1, "4.0.0",   "",    "expired",         false, ""}},
		{{"1279", 1, "4.4.6",   "",    "networkerror",    false, ""}},
		{{"1282", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1285", 1, "5.7.0",   "554", "spamdetected",    false, ""}},
		{{"1287", 1, "5.0.0",   "550", "filtered",        false, ""}},
		{{"1288", 1, "5.3.4",   "552", "mesgtoobig",      false, ""}},
		{{"1289", 1, "4.0.0",   "",    "notaccept",       false, ""}},
		{{"1290", 1, "4.3.0",   "451", "onhold",          false, ""}},
		{{"1300", 1, "5.1.0",   "550", "userunknown",      true, ""}},
		{{"1301", 1, "5.0.0",   "",    "spamdetected",    false, ""}},
		{{"1302", 1, "5.0.0",   "550", "filtered",        false, ""}},
		{{"1303", 1, "5.0.0",   "550", "userunknown",      true, ""}},
		{{"1304", 1, "4.0.0",   "",    "notaccept",       false, ""}},
		{{"1305", 1, "5.1.8",   "501", "rejected",        false, ""}},
		{{"1306", 1, "4.0.0",   "",    "networkerror",    false, ""}},
		{{"1307", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1308", 1, "5.0.0",   "",    "policyviolation", false, ""}},
		{{"1309", 1, "5.0.0",   "553", "systemerror",     false, ""}},
		{{"1310", 1, "4.0.0",   "",    "networkerror",    false, ""}},
		{{"1312", 1, "5.1.1",   "",    "userunknown",      true, ""}},
		{{"1314", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1315", 1, "5.1.1",   "550", "userunknown",      true, ""}},
		{{"1318", 1, "5.4.1",   "550", "rejected",        false, ""}},
		{{"1319", 1, "5.0.0",   "",    "userunknown",      true, ""}},
	}; EngineTest(t, "RFC3464", secretlist, false)
}

